<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <title></title>

    <style>
        .mypost{
            width: 200px;
            height: 200px;
            border-radius: 10px;
            margin-left: auto;
            margin-right: auto;
        }

        #join{
            background-color: blue;
            color: white;
            width: 80px;
            height: 40px;
            border-radius: 3px;
            margin-top: 5px;
        }
    </style>
    <script>
        function sign_up() {
            window.location.href = "/login_sign_up";
        }

        function sign_in() {
        var id = document.getElementById('input-username').value;
        var pw = document.getElementById('input-password').value;

    if(id == ""){
        alert("아이디를 입력해주세요.");
        return false;
    } else {
        $("#help-id-login").text("")
    }

    if(pw == ""){
        alert("비밀번호를 입력해주세요.");
        return false;
    }if(pw.length < 6) {
        alert('비밀번호는 6자 이상이어야 합니다.');
        return false;
    } else {
        $("#help-password-login").text("")
    }

    let formData = new FormData();
    formData.append("username_give", id);
    formData.append("password_give", pw);
    fetch('/sign_in', { method: "POST", body: formData, }).then((res) => res.json()).then((data) => {
        console.log(data['result'])
        if (data['result'] == 'success') {
            // 쿠키에 로그인 토큰을 저장
            setCookie('mytoken', data['token'],data['token']['exp']);
            // $.cookie('mytoken', data['token'], {path: '/'});
            alert("로그인 성공")
            window.location.replace("/simplelogin2")
        } else {
            alert(data['msg'])
        }
    });
}
        function setCookie(key, value, expiredays) {
            let todayDate = new Date();
            todayDate.setDate(todayDate.getDate() + expiredays);
            document.cookie = key + "=" + escape(value) + "; path=/; expires=" + todayDate.toGMTString() + ";";
        }
    </script>
</head>

<body>
    <div class="mypost" id="post-box">
        <div>
            <h5></h5>
            <label>ID</label>
            <input id="input-username" class="form-control" placeholder="아이디 입력">
        </div>
        <div>
            <label>Password</label>
            <input id="input-password" class="form-control" placeholder="비밀번호 입력">
        </div>
        <button type="button" class="btn btn-primary" onclick="sign_in()">로그인</button>
        <button type="button" id="join" onclick="sign_up()">회원가입</button>
    </div>
</body>

</html>